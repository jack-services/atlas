# Atlas Setup Command

This command guides users through configuring Atlas for first-time use.

## Usage

```
/atlas setup
```

## Wizard Flow

When this command is invoked, follow these steps interactively:

### Step 1: Welcome
Display a welcome message explaining what Atlas does and what will be configured.

### Step 2: GitHub Organization
Ask the user for their GitHub organization name. Validate that:
- The user has access to the organization (using `gh api orgs/{org}`)
- The organization exists

### Step 3: Knowledge Repository
Ask if the user has an existing knowledge repository or wants to create a new one:
- **Existing**: Ask for the path to the local clone
- **New**: Offer to create a new repository in their organization

### Step 4: Product Repositories
Ask for paths to product repositories to connect. Allow multiple entries.
Validate that each path exists and is a git repository.

### Step 5: Vector Database (Optional)
Ask if the user wants to configure a vector database for semantic search:
- If yes, collect the PostgreSQL connection URL
- Recommend using an environment variable for security

### Step 6: Write Configuration
Create the `~/.atlas/config.yaml` file with the collected information.
Use environment variable placeholders for sensitive values.

### Step 7: Verification
- Display the created configuration
- Verify GitHub access works
- Confirm setup is complete

## Implementation

Use the AskUserQuestion tool to gather information at each step.
Use the Bash tool to:
- Validate GitHub access: `gh api orgs/{org}`
- Check if paths exist: `test -d "{path}"`
- Check if directories are git repos: `git -C "{path}" rev-parse --git-dir`
- Create config directory: `mkdir -p ~/.atlas`

Use the Write tool to create the configuration file.

## Example Configuration Output

```yaml
# Atlas Configuration
# Generated by /atlas setup

knowledge_repo: ~/repos/company-knowledge

product_repos:
  - ~/repos/main-app
  - ~/repos/api-service

github_org: acme-corp

vector_db:
  url: ${ATLAS_DATABASE_URL}
  table: atlas_embeddings
  dimensions: 1536
```

## Re-running Setup

If `~/.atlas/config.yaml` already exists:
1. Inform the user that configuration already exists
2. Ask if they want to modify it or start fresh
3. If modifying, show current values as defaults
